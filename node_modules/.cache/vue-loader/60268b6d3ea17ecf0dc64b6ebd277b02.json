{"remainingRequest":"/home/billk97/Documents/personal/projects/pi-verifier/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/billk97/Documents/personal/projects/pi-verifier/src/components/AskCredentials.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/billk97/Documents/personal/projects/pi-verifier/src/components/AskCredentials.vue","mtime":1658735200946},{"path":"/home/billk97/Documents/personal/projects/pi-verifier/node_modules/cache-loader/dist/cjs.js","mtime":1621710778188},{"path":"/home/billk97/Documents/personal/projects/pi-verifier/node_modules/babel-loader/lib/index.js","mtime":1650528685806},{"path":"/home/billk97/Documents/personal/projects/pi-verifier/node_modules/cache-loader/dist/cjs.js","mtime":1621710778188},{"path":"/home/billk97/Documents/personal/projects/pi-verifier/node_modules/vue-loader/lib/index.js","mtime":1658419021867}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CiAgICBpbXBvcnQgdG9rZW4gZnJvbSAnQC9zZXJ2aWNlcy90b2tlbicKICAgIGltcG9ydCBtdWx0aXRlbmFuY3kgZnJvbSAnQC9zZXJ2aWNlcy9tdWx0aXRlbmFuY3knCiAgICBpbXBvcnQgY29ubmVjdGlvbnMgZnJvbSAnQC9zZXJ2aWNlcy9jb25uZWN0aW9ucycKICAgIGltcG9ydCBwcmVzZW50cHJvb2YgZnJvbSAnQC9zZXJ2aWNlcy9wcmVzZW50cHJvb2YnCgogICAgZXhwb3J0IGRlZmF1bHQgewogICAgICAgIG5hbWU6ICJBc2tDcmVkZW50aWFscyIsCiAgICAgICAgY29tcG9uZW50czogewogICAgICAgIH0sCiAgICAgICAgY29tcHV0ZWQ6IHsKICAgICAgICAgICAgZ2V0SW52aXRhdGlvbigpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldEludml0YXRpb24KICAgICAgICAgICAgfSwKICAgICAgICAgICAgZ2V0QmFzZTY0SW52aXRhdGlvbigpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldEJhc2U2NEludml0YXRpb24KICAgICAgICAgICAgfSwKICAgICAgICAgICAgZ2V0Q29ubmVjdGlvbklkKCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0Q29ubmVjdGlvbklkCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGdldFByZXNFeElkKCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0UHJlc0V4SWQKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgd2F0Y2g6IHsKICAgICAgICAgICAgY29ubmVjdGlvbkNvbXBsZXRlZDogewogICAgICAgICAgICAgICAgaW1tZWRpYXRlOiB0cnVlLAogICAgICAgICAgICAgICAgaGFuZGxlcih2YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSkgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFza0ZvckNyZWRzKCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHByb29mUmVjaXZlZDogewogICAgICAgICAgICAgICAgaW1tZWRpYXRlOiB0cnVlLAogICAgICAgICAgICAgICAgaGFuZGxlcih2YWx1ZSkgewogICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSkgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZlcmlmeUNyZWRlbnRpYWxzKCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIGRhdGEoKSB7CiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICBpc1ZlcmlmaWVkOiBmYWxzZSwKICAgICAgICAgICAgICAgIHdhbGxldFRva2VuOiBudWxsLAogICAgICAgICAgICAgICAgY3VycmVudENvbm5lY3Rpb25JZDogbnVsbCwKICAgICAgICAgICAgICAgIGFjY2VwdENvbm5lY3Rpb25JbnRlcnZhbDogbnVsbCwKICAgICAgICAgICAgICAgIGNvbm5lY3Rpb25Db21wbGV0ZWQ6IGZhbHNlLAogICAgICAgICAgICAgICAgcHJvb2ZSZWNpdmVkSW5lcnZhbDogbnVsbCwKICAgICAgICAgICAgICAgIHByb29mUmVjaXZlZDogZmFsc2UsCiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIGNyZWF0ZWQgKCkgewogICAgICAgICAgICB0aGlzLmNoZWNrSWZIYXNXYWxsZXQoKQogICAgICAgICAgICB0aGlzLmNyZWF0ZUludml0YXRpb25JZk5vdEV4aXN0KCkKICAgICAgICAgICAgdGhpcy5jaGVja0lmQ29ubmVjdGlvbkhhc0JlZW5BY2NlcHRlZCgpCiAgICAgICAgICAgIHRoaXMuY2hlY2tJZkhvbGRlckhhc1NlbmRDcmVkZW50aWFscygpCiAgICAgICAgICAgIC8vIGNoZWNrIGlmIGludml0YXRpb24gc3RhdHVzIGhhcyBjaGFuZ2VkCiAgICAgICAgICAgIC8vIG9uY2UgY2hhbmdlZCBkbyBhY3Rpb24KICAgICAgICAgICAgLy8gb25jZSBzdGF0dXMgY29tcGxpdGVkCiAgICAgICAgICAgIC8vIGluaXRpYXRlIHByZXNlbnQtcHJvb2YgcHJvdG9jb2wKICAgICAgICAgICAgLy8gY2hlY2sgcGVyaW9kaWNhbGx5IGlmIHN0YXR1cyBoYXMgY2hhbmdlZAogICAgICAgICAgICAvLyB2ZXJpZnkgcHJlc2VudGF0aW9uCiAgICAgICAgICAgIC8vIHNob3cgcmVzcG9uY2UKICAgICAgICAgICAgLy8gdGhpcy5kZWxldGVPcnBoYW5Db25uZWN0aW9ucygpCiAgICAgICAgfSwKICAgICAgICBtZXRob2RzOiB7CiAgICAgICAgICAgIGNoYW5nZVRvVmVyaWZlZCgpIHsKICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgICAgIC8vIHRoaXMuaXNWZXJpZmllZCA9IHRydWU7CiAgICAgICAgICAgICAgICB9LCA1MDAwKQogICAgICAgICAgICB9LAogICAgICAgICAgICBhc3luYyBjaGVja0lmSGFzV2FsbGV0KCkgewogICAgICAgICAgICAgICAgbGV0IHJlc3AgPSBudWxsCiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIHJlc3AgPSBhd2FpdCB0b2tlbi5jaGVja0lmVG9rZW5FeGlzdCgpCiAgICAgICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oInZlcmlmaWVyLWp3dCIsIHJlc3AuZGF0YS50b2tlbikKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmNyZWF0ZVdhbGxldCgpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgfSwKICAgICAgICAgICAgYXN5bmMgY3JlYXRlV2FsbGV0KCkgewogICAgICAgICAgICAgICAgY29uc3QgcmVzcCA9IGF3YWl0IG11bHRpdGVuYW5jeS5jcmVhdGVWZXJpZmllcldhbGxldCgpCiAgICAgICAgICAgICAgICBhd2FpdCB0b2tlbi5zYXZlVG9rZW4ocmVzcC5kYXRhLnRva2VuKQogICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oInZlcmlmaWVyLWp3dCIsIHJlc3AuZGF0YS50b2tlbikKICAgICAgICAgICAgfSwKICAgICAgICAgICAgYXN5bmMgY3JlYXRlSW52aXRhdGlvbklmTm90RXhpc3QoKSB7CiAgICAgICAgICAgICAgICBpZiAodGhpcy4kc3RvcmUuZ2V0dGVycy5pbnZpdGF0aW9uRXhpc3QpIHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiaW52aXRhdGlvbiBhbHJlYWR5IGV4aXN0IikKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmdldEJhc2U2NEludml0YXRpb24pCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiY3JlYXRpbmcgaW52aXRhdGlvbiIpCiAgICAgICAgICAgICAgICBjb25zdCByZXNwID0gYXdhaXQgY29ubmVjdGlvbnMuY3JlYXRlSW52aXRhdGlvbigpCiAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgndXBkYXRlSW52aXRhdGlvbicsIHJlc3AuZGF0YSkKICAgICAgICAgICAgfSwKICAgICAgICAgICAgYXN5bmMgZGVsZXRlT3JwaGFuQ29ubmVjdGlvbnMoKSB7CiAgICAgICAgICAgICAgICBjb25zdCByZXNwID0gYXdhaXQgY29ubmVjdGlvbnMuZ2V0Q29ubmVjdGlvbnMoKQogICAgICAgICAgICAgICAgY29uc3Qgd2FsbGV0Q29ubmVjdGlvbnMgPSByZXNwLmRhdGEucmVzdWx0cwogICAgICAgICAgICAgICAgbGV0IGNvbm5lY3Rpb25zVG9CZURlbGV0ZWQgPSBbXQogICAgICAgICAgICAgICAgZm9yIChjb25zdCBjb24gb2Ygd2FsbGV0Q29ubmVjdGlvbnMpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoY29uLnJmYzIzX3N0YXRlID09PSAnaW52aXRhdGlvbi1zZW50JykgewogICAgICAgICAgICAgICAgICAgICAgICBjb25uZWN0aW9uc1RvQmVEZWxldGVkLnB1c2goY29uLmNvbm5lY3Rpb25faWQpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY29uc29sZS5sb2codGhpcy5jdXJyZW50Q29ubmVjdGlvbklkKQogICAgICAgICAgICAgICAgY29ubmVjdGlvbnNUb0JlRGVsZXRlZC5maWx0ZXIoYyA9PiB7IHJldHVybiBjID09PSB0aGlzLmN1cnJlbnRDb25uZWN0aW9uSWR9KQogICAgICAgICAgICAgICAgZm9yIChjb25zdCBjb24gb2YgY29ubmVjdGlvbnNUb0JlRGVsZXRlZCkgewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGNvbikKICAgICAgICAgICAgICAgICAgICBjb25uZWN0aW9ucy5kZWxldGVDb25uZWN0aW9uKGNvbikKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgYXN5bmMgY2hlY2tJZkNvbm5lY3Rpb25IYXNCZWVuQWNjZXB0ZWQoKSB7CiAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMuYWNjZXB0Q29ubmVjdGlvbkludGVydmFsKQogICAgICAgICAgICAgICAgdGhpcy5hY2NlcHRDb25uZWN0aW9uSW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChhc3luYygpID0+IHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiY2hlY2tJZkNvbm5lY3Rpb25IYXNCZWVuQWNjZXB0ZWQgcnVubmlubmciKQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHRoaXMuYWNjZXB0Q29ubmVjdGlvbkludGVydmFsKQogICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmNvbm5lY3Rpb25Db21wbGV0ZWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmFjY2VwdENvbm5lY3Rpb25JbnRlcnZhbCkKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3AgPSBhd2FpdCBjb25uZWN0aW9ucy5nZXRDb25uZWN0aW9uc0J5SWQodGhpcy5nZXRDb25uZWN0aW9uSWQpCiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29uID0gcmVzcC5kYXRhCiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbi5yZmMyM19zdGF0ZSA9PT0gJ3JlcXVlc3QtcmVjZWl2ZWQnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJzdGF0ZTogIixjb24ucmZjMjNfc3RhdGUsICIgY29ubmVjdGlvbjogIiwgdGhpcy5nZXRDb25uZWN0aW9uSWQgKQogICAgICAgICAgICAgICAgICAgICAgICBjb25uZWN0aW9ucy5hY2NlcHQoY29uLmNvbm5lY3Rpb25faWQpCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29ubmVjdGlvbkNvbXBsZXRlZCA9IHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmFjY2VwdENvbm5lY3Rpb25JbnRlcnZhbCkKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNvbi5yZmMyM19zdGF0ZSA9PT0gJ2NvbXBsZXRlZCcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coInN0YXRlOiAiLGNvbi5yZmMyM19zdGF0ZSwgIiBjb25uZWN0aW9uOiAiLCB0aGlzLmdldENvbm5lY3Rpb25JZCApCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29ubmVjdGlvbkNvbXBsZXRlZCA9IHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmFjY2VwdENvbm5lY3Rpb25JbnRlcnZhbCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9LCA1MDAwKQogICAgICAgICAgICB9LAogICAgICAgICAgICBhc3luYyBhc2tGb3JDcmVkcygpIHsKICAgICAgICAgICAgICAgIGlmICh0aGlzLmdldFByZXNFeElkKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIlByZXNFeElkIGFscmVhZHkgZXhpc3QiKQogICAgICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY29uc29sZS5sb2coInNlbmRpbmcgcmVxdWVzdCIpCiAgICAgICAgICAgICAgICBjb25zdCByZXNwID0gYXdhaXQgcHJlc2VudHByb29mLnNlbmRSZXF1ZXN0KHRoaXMuZ2V0Q29ubmVjdGlvbklkKQogICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ3VwZGF0ZVByZXNFeElkJywgcmVzcC5kYXRhLnByZXNfZXhfaWQpCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGFzeW5jIGNoZWNrSWZIb2xkZXJIYXNTZW5kQ3JlZGVudGlhbHMoKSB7CiAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMucHJvb2ZSZWNpdmVkSW5lcnZhbCkKICAgICAgICAgICAgICAgIHRoaXMucHJvb2ZSZWNpdmVkSW5lcnZhbCA9IHNldEludGVydmFsKGFzeW5jKCkgPT4gewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJjaGVja0lmIGhvbGRlciBoYXMgc2VuZCBjcmVkZW50aWFscyIsIHRoaXMuYWNjZXB0Q29ubmVjdGlvbkludGVydmFsKQogICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnByb29mUmVjaXZlZCkgewogICAgICAgICAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMucHJvb2ZSZWNpdmVkSW5lcnZhbCkKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5nZXRDb25uZWN0aW9uSWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2xlYXJJbnRlcnZhbCh0aGlzLnByb29mUmVjaXZlZEluZXJ2YWwpCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuZ2V0UHJlc0V4SWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2xlYXJJbnRlcnZhbCh0aGlzLnByb29mUmVjaXZlZEluZXJ2YWwpCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjb25zdCByZXNwID0gYXdhaXQgcHJlc2VudHByb29mLmdldFJlcXVlc3RCeUlkKHRoaXMuZ2V0UHJlc0V4SWQpCiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29uID0gcmVzcC5kYXRhCiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coImNoZWNrIGNyZWRlbnRpYWxzIHN0YXRlIiwgY29uLnN0YXRlKQogICAgICAgICAgICAgICAgICAgIGlmIChjb24uc3RhdGUgPT09ICdwcmVzZW50YXRpb24tcmVjZWl2ZWQnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJwcm9vZiByZWNpdmVkIGFuZCBzdGF0ZSBpcyBwcmVzZW50YXRpb24tcmVjZWl2ZWQiKQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByb29mUmVjaXZlZCA9IHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnByb29mUmVjaXZlZEluZXJ2YWwpCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjb24uc2F0ZSA9PT0gJ2RvbmUnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJwcm9vZiBhbHJlYWR5IHJlY2l2ZWQgYW5kIHN0YXRlIGlzIGRvbmUiKQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByb29mUmVjaXZlZCA9IHRydWUKICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnByb29mUmVjaXZlZEluZXJ2YWwpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSwgNTAwMCkKICAgICAgICAgICAgfSwKICAgICAgICAgICAgYXN5bmMgdmVyaWZ5Q3JlZGVudGlhbHMoKSB7CiAgICAgICAgICAgICAgICBjb25zdCByZXNwID0gYXdhaXQgcHJlc2VudHByb29mLmdldFJlcXVlc3RCeUlkKHRoaXMuZ2V0UHJlc0V4SWQpCiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygidmVyaWZpbmcgcHJvb2YiKQogICAgICAgICAgICAgICAgaWYgKHJlc3AuZGF0YS52ZXJpZmllZCkgewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJwcm9vZiBpcyB2YWxpZCIpCiAgICAgICAgICAgICAgICAgICAgdGhpcy5pc1ZlcmlmaWVkID0gdHJ1ZQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgfSwKICAgICAgICAgICAgYXN5bmMgZGVsZXRlQWxsQ3JlZFJlY29yZHMoKSB7CiAgICAgICAgICAgICAgICBjb25zdCByZXNwID0gIGF3YWl0IHByZXNlbnRwcm9vZi5nZXRSZXF1ZXN0KCkKICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdHMgPSByZXNwLmRhdGEucmVzdWx0cwogICAgICAgICAgICAgICAgZm9yIChjb25zdCByIG9mIHJlc3VsdHMpIHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiZGVsZXRpbmc6ICIsIHIucHJlc19leF9pZCkKICAgICAgICAgICAgICAgICAgICBwcmVzZW50cHJvb2YuZGVsZXRlKHIucHJlc19leF9pZCkKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0K"},{"version":3,"sources":["AskCredentials.vue"],"names":[],"mappings":";AAuBA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"AskCredentials.vue","sourceRoot":"src/components","sourcesContent":["<template>\n    <div class=\"container\">\n        <div v-if=\"!isVerified\">\n            <h1>Room is locked !</h1>\n            <h2>To access the room please scan the bellow qr code and provide some credentials</h2>\n            <img alt=\"Vue logo\" src=\"@/assets/lock-rings.png\" style=\"margin-botton: 5px\">\n            <qr-code v-if=\"getBase64Invitation\" :text=\"getBase64Invitation\" class=\"qr-code\"></qr-code>\n        </div>\n        <div v-if=\"isVerified\">\n            <h1>Room is unlock</h1>\n            <h2>Enjoi</h2>\n            <img v-if=\"isVerified\" alt=\"Vue logo\" src=\"@/assets/green-unlock.png\" style=\"margin-botton: 5px\">\n        </div>\n        <b-button @click=\"deleteAllCredRecords\" variant=\"danger\">\n            Delete all credentials records\n        </b-button>\n        <b-button @click=\"askForCreds\" variant=\"success\">\n            Ask for credentials\n        </b-button>\n    </div>\n</template>\n\n<script>\n    import token from '@/services/token'\n    import multitenancy from '@/services/multitenancy'\n    import connections from '@/services/connections'\n    import presentproof from '@/services/presentproof'\n\n    export default {\n        name: \"AskCredentials\",\n        components: {\n        },\n        computed: {\n            getInvitation() {\n                return this.$store.getters.getInvitation\n            },\n            getBase64Invitation() {\n                return this.$store.getters.getBase64Invitation\n            },\n            getConnectionId() {\n                return this.$store.getters.getConnectionId\n            },\n            getPresExId() {\n                return this.$store.getters.getPresExId\n            }\n        },\n        watch: {\n            connectionCompleted: {\n                immediate: true,\n                handler(value) {\n                    if (value) {\n                        this.askForCreds()\n                    }\n                }\n            },\n            proofRecived: {\n                immediate: true,\n                handler(value) {\n                    if (value) {\n                        this.verifyCredentials()\n                    }\n                }\n            }\n        },\n        data() {\n            return {\n                isVerified: false,\n                walletToken: null,\n                currentConnectionId: null,\n                acceptConnectionInterval: null,\n                connectionCompleted: false,\n                proofRecivedInerval: null,\n                proofRecived: false,\n            }\n        },\n        created () {\n            this.checkIfHasWallet()\n            this.createInvitationIfNotExist()\n            this.checkIfConnectionHasBeenAccepted()\n            this.checkIfHolderHasSendCredentials()\n            // check if invitation status has changed\n            // once changed do action\n            // once status complited\n            // initiate present-proof protocol\n            // check periodically if status has changed\n            // verify presentation\n            // show responce\n            // this.deleteOrphanConnections()\n        },\n        methods: {\n            changeToVerifed() {\n                setTimeout(() => {\n                    // this.isVerified = true;\n                }, 5000)\n            },\n            async checkIfHasWallet() {\n                let resp = null\n                try {\n                    resp = await token.checkIfTokenExist()\n                    localStorage.setItem(\"verifier-jwt\", resp.data.token)\n                } catch (e) {\n                    this.createWallet()\n                }\n                \n            },\n            async createWallet() {\n                const resp = await multitenancy.createVerifierWallet()\n                await token.saveToken(resp.data.token)\n                localStorage.setItem(\"verifier-jwt\", resp.data.token)\n            },\n            async createInvitationIfNotExist() {\n                if (this.$store.getters.invitationExist) {\n                    console.log(\"invitation already exist\")\n                    console.log(this.getBase64Invitation)\n                    return\n                }\n                console.log(\"creating invitation\")\n                const resp = await connections.createInvitation()\n                this.$store.dispatch('updateInvitation', resp.data)\n            },\n            async deleteOrphanConnections() {\n                const resp = await connections.getConnections()\n                const walletConnections = resp.data.results\n                let connectionsToBeDeleted = []\n                for (const con of walletConnections) {\n                    if (con.rfc23_state === 'invitation-sent') {\n                        connectionsToBeDeleted.push(con.connection_id)\n                    }\n                }\n                console.log(this.currentConnectionId)\n                connectionsToBeDeleted.filter(c => { return c === this.currentConnectionId})\n                for (const con of connectionsToBeDeleted) {\n                    console.log(con)\n                    connections.deleteConnection(con)\n                }\n            },\n            async checkIfConnectionHasBeenAccepted() {\n                clearInterval(this.acceptConnectionInterval)\n                this.acceptConnectionInterval = setInterval(async() => {\n                    console.log(\"checkIfConnectionHasBeenAccepted runninng\")\n                    console.log(this.acceptConnectionInterval)\n                    if (this.connectionCompleted) {\n                        clearInterval(this.acceptConnectionInterval)\n                        return\n                    }\n                    const resp = await connections.getConnectionsById(this.getConnectionId)\n                    const con = resp.data\n                    if (con.rfc23_state === 'request-received') {\n                        console.log(\"state: \",con.rfc23_state, \" connection: \", this.getConnectionId )\n                        connections.accept(con.connection_id)\n                        this.connectionCompleted = true\n                        clearInterval(this.acceptConnectionInterval)\n                    } else if (con.rfc23_state === 'completed') {\n                        console.log(\"state: \",con.rfc23_state, \" connection: \", this.getConnectionId )\n                        this.connectionCompleted = true\n                        clearInterval(this.acceptConnectionInterval)\n                    }\n                }, 5000)\n            },\n            async askForCreds() {\n                if (this.getPresExId) {\n                    console.log(\"PresExId already exist\")\n                    return\n                }\n                console.log(\"sending request\")\n                const resp = await presentproof.sendRequest(this.getConnectionId)\n                this.$store.dispatch('updatePresExId', resp.data.pres_ex_id)\n            },\n            async checkIfHolderHasSendCredentials() {\n                clearInterval(this.proofRecivedInerval)\n                this.proofRecivedInerval = setInterval(async() => {\n                    console.log(\"checkIf holder has send credentials\", this.acceptConnectionInterval)\n                    if (this.proofRecived) {\n                        clearInterval(this.proofRecivedInerval)\n                        return\n                    }\n                    if (!this.getConnectionId) {\n                        // clearInterval(this.proofRecivedInerval)\n                        return\n                    }\n                    if (!this.getPresExId) {\n                        // clearInterval(this.proofRecivedInerval)\n                        return\n                    }\n                    const resp = await presentproof.getRequestById(this.getPresExId)\n                    const con = resp.data\n                    console.log(\"check credentials state\", con.state)\n                    if (con.state === 'presentation-received') {\n                        console.log(\"proof recived and state is presentation-received\")\n                        this.proofRecived = true\n                        clearInterval(this.proofRecivedInerval)\n                    } else if (con.sate === 'done') {\n                        console.log(\"proof already recived and state is done\")\n                        this.proofRecived = true\n                        clearInterval(this.proofRecivedInerval)\n                    }\n                }, 5000)\n            },\n            async verifyCredentials() {\n                const resp = await presentproof.getRequestById(this.getPresExId)\n                console.log(\"verifing proof\")\n                if (resp.data.verified) {\n                    console.log(\"proof is valid\")\n                    this.isVerified = true\n                }\n\n            },\n            async deleteAllCredRecords() {\n                const resp =  await presentproof.getRequest()\n                const results = resp.data.results\n                for (const r of results) {\n                    console.log(\"deleting: \", r.pres_ex_id)\n                    presentproof.delete(r.pres_ex_id)\n                }\n            }\n        }\n    }\n</script>\n\n<style scoped>\n\n    .container {\n        color: #ffffff;\n        font-weight: bold;\n    }\n    .qr-code {\n        padding: 5px;\n        background-color: #ffffff;\n        border-radius: 10px;\n        border: 3px #DF9342 solid;\n        width: fit-content;\n        margin: 0 auto;\n    }\n\n</style>\n"]}]}