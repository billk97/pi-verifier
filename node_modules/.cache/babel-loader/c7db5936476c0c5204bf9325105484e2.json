{"remainingRequest":"/home/billk97/Documents/personal/projects/pi-verifier/node_modules/babel-loader/lib/index.js!/home/billk97/Documents/personal/projects/pi-verifier/node_modules/cache-loader/dist/cjs.js??ref--1-0!/home/billk97/Documents/personal/projects/pi-verifier/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/billk97/Documents/personal/projects/pi-verifier/src/components/AskCredentials.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/billk97/Documents/personal/projects/pi-verifier/src/components/AskCredentials.vue","mtime":1658511635865},{"path":"/home/billk97/Documents/personal/projects/pi-verifier/babel.config.js","mtime":1658419066352},{"path":"/home/billk97/Documents/personal/projects/pi-verifier/node_modules/cache-loader/dist/cjs.js","mtime":1621710778188},{"path":"/home/billk97/Documents/personal/projects/pi-verifier/node_modules/babel-loader/lib/index.js","mtime":1650528685806},{"path":"/home/billk97/Documents/personal/projects/pi-verifier/node_modules/cache-loader/dist/cjs.js","mtime":1621710778188},{"path":"/home/billk97/Documents/personal/projects/pi-verifier/node_modules/vue-loader/lib/index.js","mtime":1658419021867}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKCIvaG9tZS9iaWxsazk3L0RvY3VtZW50cy9wZXJzb25hbC9wcm9qZWN0cy9waS12ZXJpZmllci9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHQuanMiKS5kZWZhdWx0OwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1leGNlcHRpb24uc3RhY2suanMiKTsKCnZhciBfdG9rZW4gPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIkAvc2VydmljZXMvdG9rZW4iKSk7Cgp2YXIgX211bHRpdGVuYW5jeSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiQC9zZXJ2aWNlcy9tdWx0aXRlbmFuY3kiKSk7Cgp2YXIgX2Nvbm5lY3Rpb25zID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJAL3NlcnZpY2VzL2Nvbm5lY3Rpb25zIikpOwoKdmFyIF9kZWZhdWx0ID0gewogIG5hbWU6ICJBc2tDcmVkZW50aWFscyIsCiAgY29tcG9uZW50czoge30sCgogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBpbnZpdGF0aW9uQmFzZTogbnVsbCwKICAgICAgaXNWZXJpZmllZDogZmFsc2UsCiAgICAgIHdhbGxldFRva2VuOiBudWxsCiAgICB9OwogIH0sCgogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmNoYW5nZVRvVmVyaWZlZCgpOwogICAgdGhpcy5jaGVja0lmSGFzV2FsbGV0KCk7CiAgICB0aGlzLmNyZWF0ZUludml0YXRpb24oKTsgLy8gY2hlY2sgaWYgd2FsbGV0IGV4aXN0cwogICAgLy8gaWYgbm90IGV4aXN0cywgY3JlYXRlCiAgICAvLyBzYXZlIGJlYXJlciB0b2tlbgogICAgLy8gc2VuZCBiZWFyZXIgdG9la2VuIHRvIGJhY2tlbmQgZm9yIHNhZmUga2lwcGluZwogICAgLy8gY3JlYXRlIGludml0YXRpb24KICAgIC8vIGNoZWNrIGlmIGludml0YXRpb24gc3RhdHVzIGhhcyBjaGFuZ2VkCiAgICAvLyBvbmNlIGNoYW5nZWQgZG8gYWN0aW9uCiAgICAvLyBvbmNlIHN0YXR1cyBjb21wbGl0ZWQKICAgIC8vIGluaXRpYXRlIHByZXNlbnQtcHJvb2YgcHJvdG9jb2wKICAgIC8vIGNoZWNrIHBlcmlvZGljYWxseSBpZiBzdGF0dXMgaGFzIGNoYW5nZWQKICAgIC8vIHZlcmlmeSBwcmVzZW50YXRpb24KICAgIC8vIHNob3cgcmVzcG9uY2UKICB9LAoKICBtZXRob2RzOiB7CiAgICBjaGFuZ2VUb1ZlcmlmZWQoKSB7CiAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIHRoaXMuaXNWZXJpZmllZCA9IHRydWU7CiAgICAgIH0sIDUwMDApOwogICAgfSwKCiAgICBhc3luYyBjaGVja0lmSGFzV2FsbGV0KCkgewogICAgICBsZXQgcmVzcCA9IG51bGw7CgogICAgICB0cnkgewogICAgICAgIHJlc3AgPSBhd2FpdCBfdG9rZW4uZGVmYXVsdC5jaGVja0lmVG9rZW5FeGlzdCgpOwogICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCJ2ZXJpZmllci1qd3QiLCByZXNwLmRhdGEudG9rZW4pOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgdGhpcy5jcmVhdGVXYWxsZXQoKTsKICAgICAgfQogICAgfSwKCiAgICBhc3luYyBjcmVhdGVXYWxsZXQoKSB7CiAgICAgIGNvbnN0IHJlc3AgPSBhd2FpdCBfbXVsdGl0ZW5hbmN5LmRlZmF1bHQuY3JlYXRlVmVyaWZpZXJXYWxsZXQoKTsKICAgICAgYXdhaXQgX3Rva2VuLmRlZmF1bHQuc2F2ZVRva2VuKHJlc3AuZGF0YS50b2tlbik7CiAgICB9LAoKICAgIGFzeW5jIGNyZWF0ZUludml0YXRpb24oKSB7CiAgICAgIGNvbnN0IHJlc3AgPSBhd2FpdCBfY29ubmVjdGlvbnMuZGVmYXVsdC5jcmVhdGVJbnZpdGF0aW9uKCk7CiAgICAgIHRoaXMuaW52aXRhdGlvbkJhc2UgPSBidG9hKEpTT04uc3RyaW5naWZ5KHJlc3AuZGF0YS5pbnZpdGF0aW9uKSk7CiAgICAgIGNvbnNvbGUubG9nKHJlc3AuZGF0YS5pbnZpdGF0aW9uKTsKICAgIH0KCiAgfQp9OwpleHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDs="},{"version":3,"mappings":";;;;;;;;;;;AAiBA;;AACA;;AACA;;eAEA;EACAA,sBADA;EAEAC,cAFA;;EAIAC;IACA;MACAC,oBADA;MAEAC,iBAFA;MAGAC;IAHA;EAKA,CAVA;;EAWAC;IACA;IACA;IACA,wBAHA,CAIA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;EACA,CA3BA;;EA4BAC;IACAC;MACAC;QACA;MACA,CAFA,EAEA,IAFA;IAGA,CALA;;IAMA;MACA;;MACA;QACAC;QACAC;MACA,CAHA,CAGA;QACA;MACA;IAEA,CAfA;;IAgBA;MACA;MACA;IACA,CAnBA;;IAoBA;MACA;MACA;MACAC;IACA;;EAxBA;AA5BA,C","names":["name","components","data","invitationBase","isVerified","walletToken","created","methods","changeToVerifed","setTimeout","resp","localStorage","console"],"sourceRoot":"src/components","sources":["AskCredentials.vue"],"sourcesContent":["<template>\n    <div class=\"container\">\n        <div v-if=\"!isVerified\">\n            <h1>Room is locked !</h1>\n            <h2>To access the room please scan the bellow qr code and provide some credentials</h2>\n            <img alt=\"Vue logo\" src=\"@/assets/lock-rings.png\" style=\"margin-botton: 5px\">\n            <qr-code v-if=\"invitationBase\" :text=\"invitationBase\" class=\"qr-code\"></qr-code>\n        </div>\n        <div v-if=\"isVerified\">\n            <h1>Room is unlock</h1>\n            <h2>Enjoi</h2>\n            <img v-if=\"isVerified\" alt=\"Vue logo\" src=\"@/assets/green-unlock.png\" style=\"margin-botton: 5px\">\n        </div>\n    </div>\n</template>\n\n<script>\n    import token from '@/services/token'\n    import multitenancy from '@/services/multitenancy'\n    import connections from '@/services/connections'\n\n    export default {\n        name: \"AskCredentials\",\n        components: {\n        },\n        data() {\n            return {\n                invitationBase: null,\n                isVerified: false,\n                walletToken: null\n            }\n        },\n        created () {\n            this.changeToVerifed()\n            this.checkIfHasWallet()\n            this.createInvitation()\n            // check if wallet exists\n            // if not exists, create\n            // save bearer token\n            // send bearer toeken to backend for safe kipping\n            // create invitation\n            // check if invitation status has changed\n            // once changed do action\n            // once status complited\n            // initiate present-proof protocol\n            // check periodically if status has changed\n            // verify presentation\n            // show responce\n        },\n        methods: {\n            changeToVerifed() {\n                setTimeout(() => {\n                    this.isVerified = true;\n                }, 5000)\n            },\n            async checkIfHasWallet() {\n                let resp = null\n                try {\n                    resp = await token.checkIfTokenExist()\n                    localStorage.setItem(\"verifier-jwt\", resp.data.token)\n                } catch (e) {\n                    this.createWallet()\n                }\n                \n            },\n            async createWallet() {\n                const resp = await multitenancy.createVerifierWallet()\n                await token.saveToken(resp.data.token)\n            },\n            async createInvitation() {\n                const resp = await connections.createInvitation()\n                this.invitationBase =  btoa(JSON.stringify(resp.data.invitation))\n                console.log(resp.data.invitation)\n            }\n        }\n    }\n</script>\n\n<style scoped>\n\n    .container {\n        color: #ffffff;\n        font-weight: bold;\n    }\n    .qr-code {\n        padding: 5px;\n        background-color: #ffffff;\n        border-radius: 10px;\n        border: 3px #DF9342 solid;\n        width: fit-content;\n        margin: 0 auto;\n    }\n\n</style>\n"]}]}