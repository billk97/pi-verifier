{"remainingRequest":"/home/billk97/Documents/personal/projects/pi-verifier/node_modules/babel-loader/lib/index.js!/home/billk97/Documents/personal/projects/pi-verifier/node_modules/cache-loader/dist/cjs.js??ref--1-0!/home/billk97/Documents/personal/projects/pi-verifier/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/billk97/Documents/personal/projects/pi-verifier/src/components/AskCredentials.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/billk97/Documents/personal/projects/pi-verifier/src/components/AskCredentials.vue","mtime":1660033583840},{"path":"/home/billk97/Documents/personal/projects/pi-verifier/babel.config.js","mtime":1659349902635},{"path":"/home/billk97/Documents/personal/projects/pi-verifier/node_modules/cache-loader/dist/cjs.js","mtime":1659349903235},{"path":"/home/billk97/Documents/personal/projects/pi-verifier/node_modules/babel-loader/lib/index.js","mtime":1659349902843},{"path":"/home/billk97/Documents/personal/projects/pi-verifier/node_modules/cache-loader/dist/cjs.js","mtime":1659349903235},{"path":"/home/billk97/Documents/personal/projects/pi-verifier/node_modules/vue-loader/lib/index.js","mtime":1659349904503}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKCIvaG9tZS9iaWxsazk3L0RvY3VtZW50cy9wZXJzb25hbC9wcm9qZWN0cy9waS12ZXJpZmllci9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHQuanMiKS5kZWZhdWx0OwoKT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgewogIHZhbHVlOiB0cnVlCn0pOwpleHBvcnRzLmRlZmF1bHQgPSB2b2lkIDA7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5jbHVkZXMuanMiKTsKCnZhciBfdG9rZW4gPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIkAvc2VydmljZXMvdG9rZW4iKSk7Cgp2YXIgX211bHRpdGVuYW5jeSA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiQC9zZXJ2aWNlcy9tdWx0aXRlbmFuY3kiKSk7Cgp2YXIgX2Nvbm5lY3Rpb25zID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJAL3NlcnZpY2VzL2Nvbm5lY3Rpb25zIikpOwoKdmFyIF9wcmVzZW50cHJvb2YgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoIkAvc2VydmljZXMvcHJlc2VudHByb29mIikpOwoKdmFyIF9kZWZhdWx0ID0gewogIG5hbWU6ICJBc2tDcmVkZW50aWFscyIsCiAgY29tcG9uZW50czoge30sCiAgY29tcHV0ZWQ6IHsKICAgIGdldEludml0YXRpb24oKSB7CiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldEludml0YXRpb247CiAgICB9LAoKICAgIGdldEJhc2U2NEludml0YXRpb24oKSB7CiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5nZXR0ZXJzLmdldEJhc2U2NEludml0YXRpb247CiAgICB9LAoKICAgIGdldENvbm5lY3Rpb25JZCgpIHsKICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0Q29ubmVjdGlvbklkOwogICAgfSwKCiAgICBnZXRQcmVzRXhJZCgpIHsKICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0UHJlc0V4SWQ7CiAgICB9CgogIH0sCiAgd2F0Y2g6IHsKICAgIGNvbm5lY3Rpb25Db21wbGV0ZWQ6IHsKICAgICAgaW1tZWRpYXRlOiB0cnVlLAoKICAgICAgaGFuZGxlcih2YWx1ZSkgewogICAgICAgIGlmICh2YWx1ZSkgewogICAgICAgICAgdGhpcy5hc2tGb3JDcmVkcygpOwogICAgICAgIH0KICAgICAgfQoKICAgIH0sCiAgICBwcm9vZlJlY2l2ZWQ6IHsKICAgICAgaW1tZWRpYXRlOiB0cnVlLAoKICAgICAgaGFuZGxlcih2YWx1ZSkgewogICAgICAgIGlmICh2YWx1ZSkgewogICAgICAgICAgdGhpcy52ZXJpZnlDcmVkZW50aWFscygpOwogICAgICAgIH0KICAgICAgfQoKICAgIH0KICB9LAoKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgaXNWZXJpZmllZDogZmFsc2UsCiAgICAgIHdhbGxldFRva2VuOiBudWxsLAogICAgICBjdXJyZW50Q29ubmVjdGlvbklkOiBudWxsLAogICAgICBhY2NlcHRDb25uZWN0aW9uSW50ZXJ2YWw6IG51bGwsCiAgICAgIGNvbm5lY3Rpb25Db21wbGV0ZWQ6IGZhbHNlLAogICAgICBwcm9vZlJlY2l2ZWRJbmVydmFsOiBudWxsLAogICAgICBwcm9vZlJlY2l2ZWQ6IGZhbHNlCiAgICB9OwogIH0sCgogIGFzeW5jIGNyZWF0ZWQoKSB7CiAgICBhd2FpdCB0aGlzLmNoZWNrSWZIYXNXYWxsZXQoKTsKICAgIGF3YWl0IHRoaXMuY3JlYXRlSW52aXRhdGlvbklmTm90RXhpc3QoKTsKICAgIHRoaXMuY2hlY2tJZkNvbm5lY3Rpb25IYXNCZWVuQWNjZXB0ZWQoKTsKICAgIHRoaXMuY2hlY2tJZkhvbGRlckhhc1NlbmRDcmVkZW50aWFscygpOwogIH0sCgogIG1ldGhvZHM6IHsKICAgIGFzeW5jIGNoZWNrSWZIYXNXYWxsZXQoKSB7CiAgICAgIGxldCByZXNwID0gbnVsbDsKCiAgICAgIHRyeSB7CiAgICAgICAgcmVzcCA9IGF3YWl0IF90b2tlbi5kZWZhdWx0LmNoZWNrSWZUb2tlbkV4aXN0KCk7CiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oInZlcmlmaWVyLWp3dCIsIHJlc3AuZGF0YS50b2tlbik7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICB0aGlzLmNyZWF0ZVdhbGxldCgpOwogICAgICB9CiAgICB9LAoKICAgIGFzeW5jIGNyZWF0ZVdhbGxldCgpIHsKICAgICAgY29uc3QgcmVzcCA9IGF3YWl0IF9tdWx0aXRlbmFuY3kuZGVmYXVsdC5jcmVhdGVWZXJpZmllcldhbGxldCgpOwogICAgICBhd2FpdCBfdG9rZW4uZGVmYXVsdC5zYXZlVG9rZW4ocmVzcC5kYXRhLnRva2VuKTsKICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oInZlcmlmaWVyLWp3dCIsIHJlc3AuZGF0YS50b2tlbik7CiAgICB9LAoKICAgIGFzeW5jIGNyZWF0ZUludml0YXRpb25JZk5vdEV4aXN0KCkgewogICAgICBpZiAodGhpcy4kc3RvcmUuZ2V0dGVycy5pbnZpdGF0aW9uRXhpc3QpIHsKICAgICAgICBjb25zb2xlLmxvZygiaW52aXRhdGlvbiBhbHJlYWR5IGV4aXN0Iik7CiAgICAgICAgY29uc29sZS5sb2codGhpcy5nZXRCYXNlNjRJbnZpdGF0aW9uKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGNvbnNvbGUubG9nKCJjcmVhdGluZyBpbnZpdGF0aW9uIik7CiAgICAgIGNvbnN0IHJlc3AgPSBhd2FpdCBfY29ubmVjdGlvbnMuZGVmYXVsdC5jcmVhdGVJbnZpdGF0aW9uKCk7CiAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCd1cGRhdGVJbnZpdGF0aW9uJywgcmVzcC5kYXRhKTsKICAgIH0sCgogICAgYXN5bmMgZGVsZXRlT3JwaGFuQ29ubmVjdGlvbnMoKSB7CiAgICAgIGNvbnN0IHJlc3AgPSBhd2FpdCBfY29ubmVjdGlvbnMuZGVmYXVsdC5nZXRDb25uZWN0aW9ucygpOwogICAgICBjb25zdCB3YWxsZXRDb25uZWN0aW9ucyA9IHJlc3AuZGF0YS5yZXN1bHRzOwogICAgICBsZXQgY29ubmVjdGlvbnNUb0JlRGVsZXRlZCA9IFtdOwoKICAgICAgZm9yIChjb25zdCBjb24gb2Ygd2FsbGV0Q29ubmVjdGlvbnMpIHsKICAgICAgICBpZiAoY29uLnJmYzIzX3N0YXRlID09PSAnaW52aXRhdGlvbi1zZW50JykgewogICAgICAgICAgY29ubmVjdGlvbnNUb0JlRGVsZXRlZC5wdXNoKGNvbi5jb25uZWN0aW9uX2lkKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIGNvbnNvbGUubG9nKHRoaXMuY3VycmVudENvbm5lY3Rpb25JZCk7CiAgICAgIGNvbm5lY3Rpb25zVG9CZURlbGV0ZWQuZmlsdGVyKGMgPT4gewogICAgICAgIHJldHVybiBjID09PSB0aGlzLmN1cnJlbnRDb25uZWN0aW9uSWQ7CiAgICAgIH0pOwoKICAgICAgZm9yIChjb25zdCBjb24gb2YgY29ubmVjdGlvbnNUb0JlRGVsZXRlZCkgewogICAgICAgIGNvbnNvbGUubG9nKGNvbik7CgogICAgICAgIF9jb25uZWN0aW9ucy5kZWZhdWx0LmRlbGV0ZUNvbm5lY3Rpb24oY29uKTsKICAgICAgfQogICAgfSwKCiAgICBhc3luYyBjaGVja0lmQ29ubmVjdGlvbkhhc0JlZW5BY2NlcHRlZCgpIHsKICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmFjY2VwdENvbm5lY3Rpb25JbnRlcnZhbCk7CiAgICAgIHRoaXMuYWNjZXB0Q29ubmVjdGlvbkludGVydmFsID0gc2V0SW50ZXJ2YWwoYXN5bmMgKCkgPT4gewogICAgICAgIGNvbnNvbGUubG9nKCJjaGVja0lmQ29ubmVjdGlvbkhhc0JlZW5BY2NlcHRlZCBydW5uaW5uZyIpOwogICAgICAgIGNvbnNvbGUubG9nKHRoaXMuYWNjZXB0Q29ubmVjdGlvbkludGVydmFsKTsKCiAgICAgICAgaWYgKHRoaXMuY29ubmVjdGlvbkNvbXBsZXRlZCkgewogICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmFjY2VwdENvbm5lY3Rpb25JbnRlcnZhbCk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBjb25zdCByZXNwID0gYXdhaXQgX2Nvbm5lY3Rpb25zLmRlZmF1bHQuZ2V0Q29ubmVjdGlvbnNCeUlkKHRoaXMuZ2V0Q29ubmVjdGlvbklkKTsKICAgICAgICBjb25zdCBjb24gPSByZXNwLmRhdGE7CgogICAgICAgIGlmIChjb24ucmZjMjNfc3RhdGUgPT09ICdyZXF1ZXN0LXJlY2VpdmVkJykgewogICAgICAgICAgY29uc29sZS5sb2coInN0YXRlOiAiLCBjb24ucmZjMjNfc3RhdGUsICIgY29ubmVjdGlvbjogIiwgdGhpcy5nZXRDb25uZWN0aW9uSWQpOwogICAgICAgICAgYXdhaXQgX2Nvbm5lY3Rpb25zLmRlZmF1bHQuYWNjZXB0KGNvbi5jb25uZWN0aW9uX2lkKTsKICAgICAgICAgIHRoaXMuY29ubmVjdGlvbkNvbXBsZXRlZCA9IHRydWU7CiAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMuYWNjZXB0Q29ubmVjdGlvbkludGVydmFsKTsKICAgICAgICB9IGVsc2UgaWYgKGNvbi5yZmMyM19zdGF0ZSA9PT0gJ2NvbXBsZXRlZCcpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJzdGF0ZTogIiwgY29uLnJmYzIzX3N0YXRlLCAiIGNvbm5lY3Rpb246ICIsIHRoaXMuZ2V0Q29ubmVjdGlvbklkKTsKICAgICAgICAgIHRoaXMuY29ubmVjdGlvbkNvbXBsZXRlZCA9IHRydWU7CiAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMuYWNjZXB0Q29ubmVjdGlvbkludGVydmFsKTsKICAgICAgICB9CiAgICAgIH0sIDUwMDApOwogICAgfSwKCiAgICBhc3luYyBhc2tGb3JDcmVkcygpIHsKICAgICAgaWYgKCF0aGlzLmNvbm5lY3Rpb25Db21wbGV0ZWQpIHsKICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJ3YWl0aW5nIDIgc2Vjb25kcyIpOwogICAgICAgIH0sIDIwMDApOwogICAgICB9CgogICAgICBpZiAodGhpcy5nZXRQcmVzRXhJZCkgewogICAgICAgIGNvbnNvbGUubG9nKCJQcmVzRXhJZCBhbHJlYWR5IGV4aXN0Iik7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBjb25zb2xlLmxvZygic2VuZGluZyByZXF1ZXN0Iik7CiAgICAgIGNvbnN0IHJlc3AgPSBhd2FpdCBfcHJlc2VudHByb29mLmRlZmF1bHQuc2VuZFJlcXVlc3QodGhpcy5nZXRDb25uZWN0aW9uSWQpOwogICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgndXBkYXRlUHJlc0V4SWQnLCByZXNwLmRhdGEucHJlc19leF9pZCk7CiAgICB9LAoKICAgIGFzeW5jIGNoZWNrSWZIb2xkZXJIYXNTZW5kQ3JlZGVudGlhbHMoKSB7CiAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5wcm9vZlJlY2l2ZWRJbmVydmFsKTsKICAgICAgdGhpcy5wcm9vZlJlY2l2ZWRJbmVydmFsID0gc2V0SW50ZXJ2YWwoYXN5bmMgKCkgPT4gewogICAgICAgIGNvbnNvbGUubG9nKCJjaGVja0lmIGhvbGRlciBoYXMgc2VuZCBjcmVkZW50aWFscyIsIHRoaXMuYWNjZXB0Q29ubmVjdGlvbkludGVydmFsKTsKCiAgICAgICAgaWYgKHRoaXMucHJvb2ZSZWNpdmVkKSB7CiAgICAgICAgICBjbGVhckludGVydmFsKHRoaXMucHJvb2ZSZWNpdmVkSW5lcnZhbCk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAoIXRoaXMuZ2V0Q29ubmVjdGlvbklkKSB7CiAgICAgICAgICAvLyBjbGVhckludGVydmFsKHRoaXMucHJvb2ZSZWNpdmVkSW5lcnZhbCkKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlmICghdGhpcy5nZXRQcmVzRXhJZCkgewogICAgICAgICAgLy8gY2xlYXJJbnRlcnZhbCh0aGlzLnByb29mUmVjaXZlZEluZXJ2YWwpCiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBjb25zdCByZXNwID0gYXdhaXQgX3ByZXNlbnRwcm9vZi5kZWZhdWx0LmdldFJlcXVlc3RCeUlkKHRoaXMuZ2V0UHJlc0V4SWQpOwogICAgICAgIGNvbnN0IGNvbiA9IHJlc3AuZGF0YTsKICAgICAgICBjb25zb2xlLmxvZygiY2hlY2sgY3JlZGVudGlhbHMgc3RhdGUiLCBjb24uc3RhdGUpOwoKICAgICAgICBpZiAoY29uLnN0YXRlID09PSAncHJlc2VudGF0aW9uLXJlY2VpdmVkJykgewogICAgICAgICAgY29uc29sZS5sb2coInByb29mIHJlY2l2ZWQgYW5kIHN0YXRlIGlzIHByZXNlbnRhdGlvbi1yZWNlaXZlZCIpOwogICAgICAgICAgdGhpcy5wcm9vZlJlY2l2ZWQgPSB0cnVlOwogICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnByb29mUmVjaXZlZEluZXJ2YWwpOwogICAgICAgIH0gZWxzZSBpZiAoY29uLnNhdGUgPT09ICdkb25lJykgewogICAgICAgICAgY29uc29sZS5sb2coInByb29mIGFscmVhZHkgcmVjaXZlZCBhbmQgc3RhdGUgaXMgZG9uZSIpOwogICAgICAgICAgdGhpcy5wcm9vZlJlY2l2ZWQgPSB0cnVlOwogICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnByb29mUmVjaXZlZEluZXJ2YWwpOwogICAgICAgIH0KICAgICAgfSwgNTAwMCk7CiAgICB9LAoKICAgIGFzeW5jIHZlcmlmeUNyZWRlbnRpYWxzKCkgewogICAgICBjb25zdCByZXNwID0gYXdhaXQgX3ByZXNlbnRwcm9vZi5kZWZhdWx0LnZlcmlmeSh0aGlzLmdldFByZXNFeElkKTsKICAgICAgY29uc29sZS5sb2coInZlcmlmaW5nIHByb29mIiwgcmVzcC5kYXRhKTsKICAgICAgY29uc3QgY29udGFpbnNSb29tID0gcmVzcC5kYXRhLmJ5X2Zvcm1hdC5wcmVzLmRpZi52ZXJpZmlhYmxlQ3JlZGVudGlhbFswXS5jcmVkZW50aWFsU3ViamVjdC5Sb29tQ3JlZGVudGlhbDsKICAgICAgY29uc3QgaW5jbHVkZXNSZXF1ZXN0ZWRSb29tID0gY29udGFpbnNSb29tLmluY2x1ZGVzKCJDQU5fQUNDRVNTX1JPT01fMSIpOwoKICAgICAgaWYgKHJlc3AuZGF0YS52ZXJpZmllZCAmJiBpbmNsdWRlc1JlcXVlc3RlZFJvb20pIHsKICAgICAgICBjb25zb2xlLmxvZygicHJvb2YgaXMgdmFsaWQiKTsKICAgICAgICB0aGlzLmlzVmVyaWZpZWQgPSB0cnVlOwogICAgICB9CiAgICB9LAoKICAgIGFzeW5jIGRlbGV0ZUFsbENyZWRSZWNvcmRzKCkgewogICAgICBjb25zdCByZXNwID0gYXdhaXQgX3ByZXNlbnRwcm9vZi5kZWZhdWx0LmdldFJlcXVlc3QoKTsKICAgICAgY29uc3QgcmVzdWx0cyA9IHJlc3AuZGF0YS5yZXN1bHRzOwoKICAgICAgZm9yIChjb25zdCByIG9mIHJlc3VsdHMpIHsKICAgICAgICBjb25zb2xlLmxvZygiZGVsZXRpbmc6ICIsIHIucHJlc19leF9pZCk7CgogICAgICAgIF9wcmVzZW50cHJvb2YuZGVmYXVsdC5kZWxldGUoci5wcmVzX2V4X2lkKTsKICAgICAgfQogICAgfQoKICB9Cn07CmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0Ow=="},{"version":3,"mappings":";;;;;;;;;;;AAuBA;;AACA;;AACA;;AACA;;eAEA;EACAA,sBADA;EAEAC,cAFA;EAIAC;IACAC;MACA;IACA,CAHA;;IAIAC;MACA;IACA,CANA;;IAOAC;MACA;IACA,CATA;;IAUAC;MACA;IACA;;EAZA,CAJA;EAkBAC;IACAC;MACAC,eADA;;MAEAC;QACA;UACA;QACA;MACA;;IANA,CADA;IASAC;MACAF,eADA;;MAEAC;QACA;UACA;QACA;MACA;;IANA;EATA,CAlBA;;EAoCAE;IACA;MACAC,iBADA;MAEAC,iBAFA;MAGAC,yBAHA;MAIAC,8BAJA;MAKAR,0BALA;MAMAS,yBANA;MAOAN;IAPA;EASA,CA9CA;;EA+CA;IACA;IACA;IACA;IACA;EACA,CApDA;;EAqDAO;IACA;MACA;;MACA;QACAC;QACAC;MACA,CAHA,CAGA;QACA;MACA;IACA,CATA;;IAUA;MACA;MACA;MACAA;IACA,CAdA;;IAeA;MACA;QACAC;QACAA;QACA;MACA;;MACAA;MACA;MACA;IACA,CAxBA;;IAyBA;MACA;MACA;MACA;;MACA;QACA;UACAC;QACA;MACA;;MACAD;MACAC;QAAA;MAAA;;MACA;QACAD;;QACAE;MACA;IACA,CAxCA;;IAyCA;MACAC;MACA;QACAH;QACAA;;QACA;UACAG;UACA;QACA;;QACA;QACA;;QACA;UACAH;UACA;UACA;UACAG;QACA,CALA,MAKA;UACAH;UACA;UACAG;QACA;MACA,CAnBA,EAmBA,IAnBA;IAoBA,CA/DA;;IAgEA;MACA;QACAC;UACAJ;QACA,CAFA,EAEA,IAFA;MAGA;;MACA;QACAA;QACA;MACA;;MACAA;MACA;MACA;IACA,CA7EA;;IA8EA;MACAG;MACA;QACAH;;QACA;UACAG;UACA;QACA;;QACA;UACA;UACA;QACA;;QACA;UACA;UACA;QACA;;QACA;QACA;QACAH;;QACA;UACAA;UACA;UACAG;QACA,CAJA,MAIA;UACAH;UACA;UACAG;QACA;MACA,CA1BA,EA0BA,IA1BA;IA2BA,CA3GA;;IA4GA;MACA;MACAH;MACA;MACA;;MACA;QACAA;QACA;MACA;IAEA,CAtHA;;IAuHA;MACA;MACA;;MACA;QACAA;;QACAK;MACA;IACA;;EA9HA;AArDA,C","names":["name","components","computed","getInvitation","getBase64Invitation","getConnectionId","getPresExId","watch","connectionCompleted","immediate","handler","proofRecived","data","isVerified","walletToken","currentConnectionId","acceptConnectionInterval","proofRecivedInerval","methods","resp","localStorage","console","connectionsToBeDeleted","connections","clearInterval","setTimeout","presentproof"],"sourceRoot":"src/components","sources":["AskCredentials.vue"],"sourcesContent":["<template>\n    <div class=\"custom-container verifier-background\" :class=\"{'verifier-background-green': isVerified}\">\n        <div v-if=\"!isVerified\">\n            <h1>Room is locked !</h1>\n            <h2>To access the room please scan the bellow qr code and provide some credentials</h2>\n            <img alt=\"Vue logo\" src=\"@/assets/lock-rings.png\" style=\"margin-botton: 5px\">\n            <qr-code v-if=\"getBase64Invitation\" :text=\"getBase64Invitation\" class=\"qr-code\"></qr-code>\n        </div>\n        <div v-if=\"isVerified\">\n            <h1>Room is unlock</h1>\n            <h2>Enjoi</h2>\n            <img v-if=\"isVerified\" alt=\"Vue logo\" src=\"@/assets/green-unlock.png\" style=\"margin-botton: 5px\">\n        </div>\n        <b-button @click=\"deleteAllCredRecords\" variant=\"danger\">\n            Delete all credentials records\n        </b-button>\n        <b-button @click=\"askForCreds\" variant=\"success\">\n            Ask for credentials\n        </b-button>\n    </div>\n</template>\n\n<script>\n    import token from '@/services/token'\n    import multitenancy from '@/services/multitenancy'\n    import connections from '@/services/connections'\n    import presentproof from '@/services/presentproof'\n\n    export default {\n        name: \"AskCredentials\",\n        components: {\n        },\n        computed: {\n            getInvitation() {\n                return this.$store.getters.getInvitation\n            },\n            getBase64Invitation() {\n                return this.$store.getters.getBase64Invitation\n            },\n            getConnectionId() {\n                return this.$store.getters.getConnectionId\n            },\n            getPresExId() {\n                return this.$store.getters.getPresExId\n            }\n        },\n        watch: {\n            connectionCompleted: {\n                immediate: true,\n                handler(value) {\n                    if (value) {\n                        this.askForCreds()\n                    }\n                }\n            },\n            proofRecived: {\n                immediate: true,\n                handler(value) {\n                    if (value) {\n                        this.verifyCredentials()\n                    }\n                }\n            }\n        },\n        data() {\n            return {\n                isVerified: false,\n                walletToken: null,\n                currentConnectionId: null,\n                acceptConnectionInterval: null,\n                connectionCompleted: false,\n                proofRecivedInerval: null,\n                proofRecived: false,\n            }\n        },\n        async created () {\n            await this.checkIfHasWallet()\n            await this.createInvitationIfNotExist()\n            this.checkIfConnectionHasBeenAccepted()\n            this.checkIfHolderHasSendCredentials()\n        },\n        methods: {\n            async checkIfHasWallet() {\n                let resp = null\n                try {\n                    resp = await token.checkIfTokenExist()\n                    localStorage.setItem(\"verifier-jwt\", resp.data.token)\n                } catch (e) {\n                    this.createWallet()\n                }\n            },\n            async createWallet() {\n                const resp = await multitenancy.createVerifierWallet()\n                await token.saveToken(resp.data.token)\n                localStorage.setItem(\"verifier-jwt\", resp.data.token)\n            },\n            async createInvitationIfNotExist() {\n                if (this.$store.getters.invitationExist) {\n                    console.log(\"invitation already exist\")\n                    console.log(this.getBase64Invitation)\n                    return\n                }\n                console.log(\"creating invitation\")\n                const resp = await connections.createInvitation()\n                this.$store.dispatch('updateInvitation', resp.data)\n            },\n            async deleteOrphanConnections() {\n                const resp = await connections.getConnections()\n                const walletConnections = resp.data.results\n                let connectionsToBeDeleted = []\n                for (const con of walletConnections) {\n                    if (con.rfc23_state === 'invitation-sent') {\n                        connectionsToBeDeleted.push(con.connection_id)\n                    }\n                }\n                console.log(this.currentConnectionId)\n                connectionsToBeDeleted.filter(c => { return c === this.currentConnectionId})\n                for (const con of connectionsToBeDeleted) {\n                    console.log(con)\n                    connections.deleteConnection(con)\n                }\n            },\n            async checkIfConnectionHasBeenAccepted() {\n                clearInterval(this.acceptConnectionInterval)\n                this.acceptConnectionInterval = setInterval(async() => {\n                    console.log(\"checkIfConnectionHasBeenAccepted runninng\")\n                    console.log(this.acceptConnectionInterval)\n                    if (this.connectionCompleted) {\n                        clearInterval(this.acceptConnectionInterval)\n                        return\n                    }\n                    const resp = await connections.getConnectionsById(this.getConnectionId)\n                    const con = resp.data\n                    if (con.rfc23_state === 'request-received') {\n                        console.log(\"state: \",con.rfc23_state, \" connection: \", this.getConnectionId )\n                        await connections.accept(con.connection_id)\n                        this.connectionCompleted = true\n                        clearInterval(this.acceptConnectionInterval)\n                    } else if (con.rfc23_state === 'completed') {\n                        console.log(\"state: \",con.rfc23_state, \" connection: \", this.getConnectionId )\n                        this.connectionCompleted = true\n                        clearInterval(this.acceptConnectionInterval)\n                    }\n                }, 5000)\n            },\n            async askForCreds() {\n                if (!this.connectionCompleted) {\n                    setTimeout(() => {\n                        console.log(\"waiting 2 seconds\")\n                    }, 2000)\n                }\n                if (this.getPresExId) {\n                    console.log(\"PresExId already exist\")\n                    return\n                }\n                console.log(\"sending request\")\n                const resp = await presentproof.sendRequest(this.getConnectionId)\n                this.$store.dispatch('updatePresExId', resp.data.pres_ex_id)\n            },\n            async checkIfHolderHasSendCredentials() {\n                clearInterval(this.proofRecivedInerval)\n                this.proofRecivedInerval = setInterval(async() => {\n                    console.log(\"checkIf holder has send credentials\", this.acceptConnectionInterval)\n                    if (this.proofRecived) {\n                        clearInterval(this.proofRecivedInerval)\n                        return\n                    }\n                    if (!this.getConnectionId) {\n                        // clearInterval(this.proofRecivedInerval)\n                        return\n                    }\n                    if (!this.getPresExId) {\n                        // clearInterval(this.proofRecivedInerval)\n                        return\n                    }\n                    const resp = await presentproof.getRequestById(this.getPresExId)\n                    const con = resp.data\n                    console.log(\"check credentials state\", con.state)\n                    if (con.state === 'presentation-received') {\n                        console.log(\"proof recived and state is presentation-received\")\n                        this.proofRecived = true\n                        clearInterval(this.proofRecivedInerval)\n                    } else if (con.sate === 'done') {\n                        console.log(\"proof already recived and state is done\")\n                        this.proofRecived = true\n                        clearInterval(this.proofRecivedInerval)\n                    }\n                }, 5000)\n            },\n            async verifyCredentials() {\n                const resp = await presentproof.verify(this.getPresExId)\n                console.log(\"verifing proof\", resp.data)\n                const containsRoom = resp.data.by_format.pres.dif.verifiableCredential[0].credentialSubject.RoomCredential\n                const includesRequestedRoom = containsRoom.includes(\"CAN_ACCESS_ROOM_1\")\n                if (resp.data.verified && includesRequestedRoom) {\n                    console.log(\"proof is valid\")\n                    this.isVerified = true\n                }\n\n            },\n            async deleteAllCredRecords() {\n                const resp =  await presentproof.getRequest()\n                const results = resp.data.results\n                for (const r of results) {\n                    console.log(\"deleting: \", r.pres_ex_id)\n                    presentproof.delete(r.pres_ex_id)\n                }\n            }\n        }\n    }\n</script>\n\n<style scoped>\n\n    .custom-container {\n        color: #ffffff;\n        width: 100%;\n        font-weight: bold;\n    }\n    .qr-code {\n        padding: 5px;\n        background-color: #ffffff;\n        border-radius: 10px;\n        border: 3px #DF9342 solid;\n        width: fit-content;\n        margin: 0 auto;\n    }\n    .verifier-background {\n        background-image: url('~@/assets/background.png') ;\n        background-repeat: no-repeat;\n        background-size: 100% 100%;\n        width: 100%;\n    }\n\n    .verifier-background-green {\n        background-image: url('~@/assets/green-background.png') ;\n    }\n</style>\n"]}]}