{"remainingRequest":"/home/billk97/Documents/personal/projects/pi-verifier/node_modules/babel-loader/lib/index.js!/home/billk97/Documents/personal/projects/pi-verifier/node_modules/eslint-loader/index.js??ref--14-0!/home/billk97/Documents/personal/projects/pi-verifier/src/utils/jwt-utils.js","dependencies":[{"path":"/home/billk97/Documents/personal/projects/pi-verifier/src/utils/jwt-utils.js","mtime":1658436007783},{"path":"/home/billk97/Documents/personal/projects/pi-verifier/babel.config.js","mtime":1658419066352},{"path":"/home/billk97/Documents/personal/projects/pi-verifier/node_modules/cache-loader/dist/cjs.js","mtime":1621710778188},{"path":"/home/billk97/Documents/personal/projects/pi-verifier/node_modules/babel-loader/lib/index.js","mtime":1650528685806},{"path":"/home/billk97/Documents/personal/projects/pi-verifier/node_modules/eslint-loader/index.js","mtime":1621710786693}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IGp3dERlY29kZSBmcm9tICdqd3QtZGVjb2RlJzsKaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnOwpleHBvcnQgZGVmYXVsdCB7CiAgaXNKd3RFeHBpcmVkKGp3dFRva2VuKSB7CiAgICB0cnkgewogICAgICBjb25zdCBkZWNvZGVkSnd0VG9rZW4gPSBqd3REZWNvZGUoand0VG9rZW4pOwogICAgICBjb25zdCBqd3RUb2tlbkV4cGlyYXRpb25UaW1lID0gZGVjb2RlZEp3dFRva2VuLmV4cDsKICAgICAgcmV0dXJuIG1vbWVudCgpLnVuaXgoKSA+IGp3dFRva2VuRXhwaXJhdGlvblRpbWU7CiAgICB9IGNhdGNoIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgfSwKCiAgand0RXhwaXJlc0luU2Vjb25kcyhqd3RUb2tlbiwgc2Vjb25kcykgewogICAgdHJ5IHsKICAgICAgY29uc3QgZGVjb2RlZEp3dFRva2VuID0gand0RGVjb2RlKGp3dFRva2VuKTsKICAgICAgY29uc3Qgand0VG9rZW5FeHBpcmF0aW9uVGltZSA9IGRlY29kZWRKd3RUb2tlbi5leHA7CiAgICAgIHJldHVybiBtb21lbnQoKS51bml4KCkgPiBqd3RUb2tlbkV4cGlyYXRpb25UaW1lIC0gc2Vjb25kczsKICAgIH0gY2F0Y2ggewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICB9LAoKICBnZXRQcml2aWxlZ2VzKGp3dFRva2VuKSB7CiAgICB0cnkgewogICAgICBjb25zdCBkZWNvZGVkSnd0VG9rZW4gPSBqd3REZWNvZGUoand0VG9rZW4pOwogICAgICByZXR1cm4gZGVjb2RlZEp3dFRva2VuLnNjb3BlcyB8fCBbXTsKICAgIH0gY2F0Y2ggewogICAgICByZXR1cm4gW107CiAgICB9CiAgfSwKCiAgaXNIbWFjNTEyKGp3dFRva2VuKSB7CiAgICBsZXQgaGVhZGVyczsKCiAgICB0cnkgewogICAgICBoZWFkZXJzID0gand0RGVjb2RlKGp3dFRva2VuLCB7CiAgICAgICAgaGVhZGVyOiB0cnVlCiAgICAgIH0pOwogICAgfSBjYXRjaCB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICByZXR1cm4gaGVhZGVycy5hbGcgPT09ICdIUzUxMic7CiAgfSwKCiAgaXNWYWxpZChqd3RUb2tlbikgewogICAgaWYgKCFqd3RUb2tlbikgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgcmV0dXJuICF0aGlzLmlzSnd0RXhwaXJlZChqd3RUb2tlbikgJiYgdGhpcy5pc0htYWM1MTIoand0VG9rZW4pOwogIH0sCgogIGlzVmFsaWRGb3JtYXQoand0VG9rZW4pIHsKICAgIGlmICghand0VG9rZW4pIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIHJldHVybiB0aGlzLmlzSG1hYzUxMihqd3RUb2tlbik7CiAgfSwKCiAgcGFyc2VUb2tlbihqd3RUb2tlbikgewogICAgcmV0dXJuIGp3dERlY29kZShqd3RUb2tlbik7CiAgfQoKfTs="},{"version":3,"names":["jwtDecode","moment","isJwtExpired","jwtToken","decodedJwtToken","jwtTokenExpirationTime","exp","unix","jwtExpiresInSeconds","seconds","getPrivileges","scopes","isHmac512","headers","header","alg","isValid","isValidFormat","parseToken"],"sources":["/home/billk97/Documents/personal/projects/pi-verifier/src/utils/jwt-utils.js"],"sourcesContent":["import jwtDecode from 'jwt-decode'\nimport moment from 'moment'\n\nexport default {\n    isJwtExpired(jwtToken) {\n        try {\n            const decodedJwtToken = jwtDecode(jwtToken)\n            const jwtTokenExpirationTime = decodedJwtToken.exp\n            return moment().unix() > jwtTokenExpirationTime\n        } catch {\n            return true\n        }\n    },\n    jwtExpiresInSeconds(jwtToken, seconds) {\n        try {\n            const decodedJwtToken = jwtDecode(jwtToken)\n            const jwtTokenExpirationTime = decodedJwtToken.exp\n            return moment().unix() > (jwtTokenExpirationTime - seconds)\n        } catch {\n            return true\n        }\n    },\n    getPrivileges(jwtToken) {\n        try {\n            const decodedJwtToken = jwtDecode(jwtToken)\n            return decodedJwtToken.scopes || []\n        } catch {\n            return []\n        }\n    },\n    isHmac512(jwtToken) {\n        let headers\n        try {\n            headers = jwtDecode(jwtToken, { header: true })\n        } catch {\n            return false\n        }\n        return headers.alg === 'HS512'\n    },\n    isValid(jwtToken) {\n        if (!jwtToken) {\n            return false\n        }\n        return !this.isJwtExpired(jwtToken) && this.isHmac512(jwtToken)\n    },\n    isValidFormat(jwtToken) {\n        if (!jwtToken) {\n            return false\n        }\n        return this.isHmac512(jwtToken)\n    },\n    parseToken(jwtToken) {\n        return jwtDecode(jwtToken)\n    }\n}\n"],"mappings":"AAAA,OAAOA,SAAP,MAAsB,YAAtB;AACA,OAAOC,MAAP,MAAmB,QAAnB;AAEA,eAAe;EACXC,YAAY,CAACC,QAAD,EAAW;IACnB,IAAI;MACA,MAAMC,eAAe,GAAGJ,SAAS,CAACG,QAAD,CAAjC;MACA,MAAME,sBAAsB,GAAGD,eAAe,CAACE,GAA/C;MACA,OAAOL,MAAM,GAAGM,IAAT,KAAkBF,sBAAzB;IACH,CAJD,CAIE,MAAM;MACJ,OAAO,IAAP;IACH;EACJ,CATU;;EAUXG,mBAAmB,CAACL,QAAD,EAAWM,OAAX,EAAoB;IACnC,IAAI;MACA,MAAML,eAAe,GAAGJ,SAAS,CAACG,QAAD,CAAjC;MACA,MAAME,sBAAsB,GAAGD,eAAe,CAACE,GAA/C;MACA,OAAOL,MAAM,GAAGM,IAAT,KAAmBF,sBAAsB,GAAGI,OAAnD;IACH,CAJD,CAIE,MAAM;MACJ,OAAO,IAAP;IACH;EACJ,CAlBU;;EAmBXC,aAAa,CAACP,QAAD,EAAW;IACpB,IAAI;MACA,MAAMC,eAAe,GAAGJ,SAAS,CAACG,QAAD,CAAjC;MACA,OAAOC,eAAe,CAACO,MAAhB,IAA0B,EAAjC;IACH,CAHD,CAGE,MAAM;MACJ,OAAO,EAAP;IACH;EACJ,CA1BU;;EA2BXC,SAAS,CAACT,QAAD,EAAW;IAChB,IAAIU,OAAJ;;IACA,IAAI;MACAA,OAAO,GAAGb,SAAS,CAACG,QAAD,EAAW;QAAEW,MAAM,EAAE;MAAV,CAAX,CAAnB;IACH,CAFD,CAEE,MAAM;MACJ,OAAO,KAAP;IACH;;IACD,OAAOD,OAAO,CAACE,GAAR,KAAgB,OAAvB;EACH,CAnCU;;EAoCXC,OAAO,CAACb,QAAD,EAAW;IACd,IAAI,CAACA,QAAL,EAAe;MACX,OAAO,KAAP;IACH;;IACD,OAAO,CAAC,KAAKD,YAAL,CAAkBC,QAAlB,CAAD,IAAgC,KAAKS,SAAL,CAAeT,QAAf,CAAvC;EACH,CAzCU;;EA0CXc,aAAa,CAACd,QAAD,EAAW;IACpB,IAAI,CAACA,QAAL,EAAe;MACX,OAAO,KAAP;IACH;;IACD,OAAO,KAAKS,SAAL,CAAeT,QAAf,CAAP;EACH,CA/CU;;EAgDXe,UAAU,CAACf,QAAD,EAAW;IACjB,OAAOH,SAAS,CAACG,QAAD,CAAhB;EACH;;AAlDU,CAAf"}]}